### Build Tools

Mbed OS includes tools for building itself in the `tools` directory. These build tools include target-specific post-build scripts. When adding a target, you may need to add a post-build script. Use a post-build script to modify a linked application binary in ways that the linker cannot, such as inserting a checksum at a specific offset. Post-build scripts are rarely exportable, and should only be used when all other options have been exhausted.

#### Post-build Scripts

The tools include post-build scripts for tasks that modify an application binary after it is linked. These tasks are written in python as static methods of a class within the `tools.targets` module. The tasks are specified as `Class.method` in targets.json. 

The tools will call the static method with 4 parameters:

 1) Toolchain object. This object may be used for logging.
 2) Resources object used for this build. This contains all of the C, C++ and ASM sources.
 3) Path to the elf file generated by the linker.
 4) Path to the binary file generated after link, or the elf file if no binary was generated.

#### Implementation

To add a post-build script, add a class with a single method into the `tools/targets/__init__.py` python file, such as:

```python
class LPCTargetCode(object):
    """General LPC Target patching"""
    @staticmethod
    def lpc_patch(t_self, resources, elf, binf):
        """Patch an elf file"""
        t_self.debug("LPC Patch: %s" % os.path.split(binf)[1])
        from .LPC import patch
        patch(binf)
```

A target that needs this post-build script run must contain this snippet in `targets/targets.json`:

```JSON
"post_binary_hook": {"function": "LPCTargetCode.lpc_patch"},
```


When implementing a post build script, please be aware of the following considerations:

 * A `.` is allowed in a project name.
 * The user may change the output file type to any of binary, Intel Hex and ELF.
 * The Arm compiler generates a directory containing a bin file for each loadable section when there is more than one loadable section.
 
